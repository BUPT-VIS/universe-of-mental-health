<html>  
  <head>  
        <meta charset="utf-8">  
        <title></title>  
  <style>
  	body {
  		background-color: #000;
	  	color: white;
  	}
	.node {
	  font: 12px sans-serif;
	}

	.link {
	  fill: none;
	  stroke: #fff;
	  stroke-width: 3px;
	}
  
  </style>
		
  </head> 

    <body>  
		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>  
        <script>
		
		var width  = 1200;	//SVG绘制区域的宽度
		var height = 500;	//SVG绘制区域的高度
			
		var svg = d3.select("body")			//选择<body>
					.append("svg")			//在<body>中添加<svg>
					.attr("width", width)	//设定<svg>的宽度属性
					.attr("height", height)
					.style("border", "solid 1px #000");//设定<svg>的高度属性
					
		var gTree = svg.append("g")
						.attr("transform","translate(100,0)");
		
		var tree = d3.layout.tree()
			.size([width/6, height/1.5])
			.separation(function(a, b) { return (a.parent == b.parent ? 1 : 2) ; });

		var diagonal = d3.svg.diagonal()
			.projection(function(d) { return [d.y, d.x]; });

		var root = {
			'name': 'self-employed',
			'children': [
				{
					'name': 'Y have pre-employers 1',
					'children': [
						{'name': 'Y star6'},
						{'name': 'N star5'}
					]
				},
				{
					'name': 'N tech/IT company',
					'children': [
						{
							'name': 'Y have pre-employers 2',
							'children': [
								{'name': 'Y star2'},
								{'name': 'N star1'}
							]
						},
						{
							'name': 'N tech/IT role',
							'children': [
								{
									'name': 'Y have pre-employers 3',
									'children': [
										{'name': 'Y star4'},
										{'name': 'N star3'}
									]
								},
								{'name': 'N'}
							]
						}
					]
				}
			]
		}
		
		//d3.json("city.json", function(error, root) {

			var nodes = tree.nodes(root);
			var links = tree.links(nodes);
			
			console.log('nodes', nodes);
			console.log('links', links);
			
			var link = gTree.selectAll(".link")
			  .data(links)
			  .enter()
			  .append("path")
			  .attr("class", "link")
			  .attr("d", diagonal);	//使用对角线生成器
			
			var node = gTree.selectAll(".node")
						  .data(nodes)
						  .enter()
						  .append("g")
						  .attr("class", "node")
						  .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; })
			
			var nodes = node.append("circle")
				.attr("r", 5)
				.attr("class", function(d) {
					return d.name;
				})
				.style("fill", "white")
				.on("mouseover", function(d,i) {
					d3.select(this).style("fill", "#00ffd4");
				})
				.on("mouseout", function(d,i) {
					d3.select(this).style("fill", "white");
				})
				.on("click", function(d) {
					var current = d;
					console.log(current.name);
					var parents = [current.name];
					for (var depth = 0; depth < d.depth; depth++) {
						current = current.parent;
						//d3.select(this).style("fill", "#00ffd4");
						parents.push(current.name);
					}
					console.log(parents);

					nodes.each(function(d) {
						if (parents.indexOf(d.name) > -1) {
							d3.select(this).style("fill", "#00ffd4");
						} else {
							d3.select(this). style("fill", "white");
						}
					});
				});
			
			node.append("text")
				  .attr("dx", function(d) { return d.children ? -8 : 8; })
				  .attr("dy", 3)
				  .style("text-anchor", function(d) { return d.children ? "end" : "start"; })
				  .style("fill", "#ccc")
				  //.style("stroke", "white")
				  //.style("stroke-width", 0.5)
				  .style("font-size", 10)
				  .text(function(d) { return d.name; });
		//});
		var arr = ['a','s','d','f'];
        console.log(arr.indexOf('e'));
        </script>  
		
    </body>  
</html>  