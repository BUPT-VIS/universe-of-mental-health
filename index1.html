<!-- @format -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.1/p5.js"></script>
  <title>test</title>
</head>

<body>
  <script>

    let data = {}; //全局对象
    let bubbles = []; //全局数组
    var datas = [];

    //载入JSON
    function preload() {
      data = loadJSON("2016.json");
    }

    //数据处理
    function loadData() {
      for (let i in data) {
        let d = {};
        d[i] = data[i];
        bubbles.push(d);
      }

      for (let i = 0; i < bubbles.length; i++) {
        var o = data[i];
        datas[i] = new Bubble(o);
      }
    }

    function setup() {
      createCanvas(windowWidth, 3000);
      //PG = creatGraphics(50,50);
      noStroke();
      loadData();
    }

    function draw() {
      background(255);
      var t = millis() / 500;
      let NumW = 20;
      let NumH = 20;
      let NumJ = 100;
    //  translate(windowWidth/2,windowHeight/2);
      //drawCircle(color(200), 1000);
     // data[1].display2;
     // Y += 0.01

      //stroke(173, 255, 47);
      //line(windowWidth / 2 + 200, 0, windowWidth / 2 + 200, windowHeight);
      for (var i = 0; i < datas.length; i++) {
        let x = 100 + (i % NumW) * NumJ;
        let y = 50 + parseInt(i / NumH) * NumJ;
        //blendMode(LIGHTEST);
        datas[i].display2(x, y);
        //Y += 0.01
      }
      

    }


    function Bubble(f) {

      this.x = f.x * 20;
      this.y = f.y * 20;
      this.age = f.age / 2
      this.R = 100;

      this.self_employed = f.self_employed;
      this.mentalVSphysical = f.mentalVSphysical;
      this.family_history = f.family_history;
      //福利
      this.health_benefits = f.health_benefits;
      this.options = f.options;
      this.discussed = f.discussed;
      this.resources_seeking_help = f.resources_seeking_help;
      //不好的影响
      this.observed_negative = f.observed_negative;

      //倾诉
      this.employer_negative = f.employer_negative;
      this.coworkers = f.coworkers;
      this.supervisor = f.supervisor;
      //过去的倾诉
      this.previous_employers_negative = f.previous_employers_negative;
      this.previous_coworkers = f.previous_coworkers;
      this.Oldsupervisor = f.Oldsupervisor;

      //心理疾病类型
      this.medical_professional = f.medical_professional;
      this.condition_PH1 = f.condition_PH1;
      this.condition_PH2 = f.condition_PH2;
      this.condition_PH3 = f.condition_PH3;
      this.condition_PH4 = f.condition_PH4;
      this.condition_PH5 = f.condition_PH5;
    



      this.display2 = function (x, y) {

        push();
        translate(0,0);
        fill(200);
        if (this.medical_professional == 'Yes') {
          if (this.condition_PH1 == 'Anxiety Disorder (Generalized, Social, Phobia, etc)') {
            fill(0,128,255);
            //c = color(0, 0, 255);
           // diff = 200;
          }

        }

        //公司待遇
        if (this.observed_negative == "Yes") {
          this.R = this.R + random(-5, 5);
          //diff = 2000;
        }
        //drawCircle(this.c, this.diff);
        ellipse(x, y, this.R, this.R);

        if (this.family_history == "Yes") {
          fill(173, 255, 47);
          ellipse(x, y, 10, 10);
        }
      
        pop();
        this.R = 100;
        
      }

      this.display = function (t) {
        // colorMode(HSB, 100);
        push();
        translate(windowWidth / 2 - 300, windowHeight / 2 - 50);



        //认为雇主重视心理健康问题
        if (this.mentalVSphysical == "No") {
          // noFill();
          // stroke(255, 200);
          this.age = this.age * sin(t)
        }
        //公司待遇
        if (this.observed_negative == "Yes") {
          this.x = this.x + random(-3, 3);
          this.y = this.y + random(-3, 3);
        }
        //家族遗传
        if (this.family_history == "Yes") {
          //noFill();
          fill(173, 255, 47);
          ellipse(this.x, this.y, 5, 5);
          // this.age = f.age/2
        }

        //公司福利 好
        // if (this.health_benefits == "Yes") {
        //   fill("#dd2c00");
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);
        //   //fill(255);
        // }
        // if (this.options == "Yes") {
        //   fill('#ff3d00');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.discussed == "Yes") {
        //   fill('#ff6e40');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.resources_seeking_help == "Yes") {
        //   fill('#ff9e80');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }


        // //公司福利 坏
        //  if (this.health_benefits == "No") {
        //  fill('#64dd17');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);
        //   //fill(255);
        // }
        // if (this.options == "No") {
        //   fill('#76ff03');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.discussed == "No") {
        //   fill('#b2ff59');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.resources_seeking_help == "No") {
        //   fill('#ccff90');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }

        //愿意倾诉
        // if (this.employer_negative == "No") {
        //   fill("#ffd600");
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);
        //   //fill(255);
        // }
        // if (this.coworkers  == "Yes") {
        //   fill('#ffea00');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.supervisor== "Yes") {
        //   fill('#ffff00');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        //   //不愿意倾诉
        // if (this.employer_negative == "Yes" && this.coworkers == "No" && this.supervisor == "No") {

        //   fill("#1de9b6");
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);
        //   //fill(255);
        // }

        // if (this.coworkers  == "No") {
        //   fill('#651fff');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }
        // if (this.supervisor== "No") {
        //   fill('#7c4dff');
        //   noStroke();
        //   ellipse(this.x, this.y, this.age, this.age);

        // }

        if (this.self_employed == 0) {
          fill(255);
          ellipse(this.x, this.y, 50, 50);
        }

        else {
          fill(255, 20);
          //stroke(255, 200);
          // this.age = f.age/2
        }



        //ellipse(this.x, this.y, this.age, this.age);
        //this.age = f.age / 2

        pop();
      }
    }

   

  </script>
</body>

</html>